(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["home"],{"3df7":function(e,t,r){},"7c49":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),t("el-breadcrumb-item",[e._v("用户管理")]),t("el-breadcrumb-item",[e._v("用户列表")])],1),t("el-card",[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},on:{clear:e.getUserList},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),t("el-col",{attrs:{span:4}},[t("el-button",{attrs:{type:"primary"},on:{click:e.addUserDialog}},[e._v("添加用户")])],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",stripe:""}},[t("el-table-column",{attrs:{type:"index"}}),t("el-table-column",{attrs:{prop:"username",label:"姓名"}}),t("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{prop:"mobile",label:"电话"}}),t("el-table-column",{attrs:{prop:"role_name",label:"角色"}}),t("el-table-column",{attrs:{prop:"mg_state",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-switch",{attrs:{"active-color":"#409eff","inactive-color":"#dcdfe6"},on:{change:function(t){return e.stateChange(r.row)}},model:{value:r.row.mg_state,callback:function(t){e.$set(r.row,"mg_state",t)},expression:"scope.row.mg_state"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(r){return[t("el-tooltip",{attrs:{enterable:!1,effect:"dark",content:"编辑",placement:"top-start"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.editDialog(r.row)}}})],1),t("el-tooltip",{attrs:{enterable:!1,effect:"dark",content:"删除",placement:"top-start"}},[t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.deleteUsersById(r.row)}}})],1),t("el-tooltip",{attrs:{enterable:!1,effect:"dark",content:"分配角色",placement:"top-start"}},[t("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(t){return e.allotRoles(r.row)}}})],1)]}}])})],1),t("pagination",{attrs:{total:e.total,queryInfo:e.queryInfo,"get-data":e.getUserList}})],1),t("el-dialog",{attrs:{title:"修改用户信息",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.resetEditDialog}},[t("el-form",{ref:"editRuleFormRef",attrs:{model:e.editRuleForm,rules:e.editRuleFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editRuleForm.username,callback:function(t){e.$set(e.editRuleForm,"username",t)},expression:"editRuleForm.username"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.editRuleForm.email,callback:function(t){e.$set(e.editRuleForm,"email",t)},expression:"editRuleForm.email"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[t("el-input",{model:{value:e.editRuleForm.mobile,callback:function(t){e.$set(e.editRuleForm,"mobile",t)},expression:"editRuleForm.mobile"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.resetAddUserDialog}},[t("el-form",{ref:"addRuleFormRef",attrs:{model:e.addRuleForm,rules:e.addRuleFormRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{model:{value:e.addRuleForm.username,callback:function(t){e.$set(e.addRuleForm,"username",t)},expression:"addRuleForm.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{model:{value:e.addRuleForm.password,callback:function(t){e.$set(e.addRuleForm,"password",t)},expression:"addRuleForm.password"}})],1),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{model:{value:e.addRuleForm.email,callback:function(t){e.$set(e.addRuleForm,"email",t)},expression:"addRuleForm.email"}})],1),t("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[t("el-input",{model:{value:e.addRuleForm.mobile,callback:function(t){e.$set(e.addRuleForm,"mobile",t)},expression:"addRuleForm.mobile"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"分配角色",visible:e.allotRolesDialogVisible,width:"40%"},on:{"update:visible":function(t){e.allotRolesDialogVisible=t}}},[t("p",[e._v("当前的用户: "+e._s(e.userInfo.username))]),t("p",{staticClass:"setMargin"},[e._v("当前的角色: "+e._s(e.userInfo.role_name))]),t("p",[e._v("当前的用户: \n      "),t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedRoles,callback:function(t){e.selectedRoles=t},expression:"selectedRoles"}},e._l(e.rolesList,(function(e,r){return t("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.allotRolesDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.allotRolesConfirm}},[e._v("确 定")])],1)])],1)},s=[],i=(r("e186"),r("c130")),n=r("93e6"),o=r("1bab"),l={name:"Users",components:{Pagination:n["a"]},data:function(){var e=function(e,t,r){var a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/;if(a.test(t))return r();r(new Error("请输入正确的邮箱格式"))},t=function(e,t,r){var a=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;if(a.test(t))return r();r(new Error("请输入正确的手机号格式"))};return{userList:[],queryInfo:{query:"",pagesize:2,pagenum:1},total:0,propsURL:{url:"users",method:"get",params:this.queryInfo},editDialogVisible:!1,editRuleForm:{id:"",username:"",email:"",mobile:"",role_id:""},editRuleFormRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validate:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validate:t,trigger:"blur"}]},addDialogVisible:!1,addRuleForm:{username:"",password:"",email:"",mobile:""},addRuleFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validate:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validate:e,trigger:"blur"}]},rowId:"",userInfo:{},allotRolesDialogVisible:!1,rolesList:[],selectedRoles:""}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])({url:"users",params:this.queryInfo});case 2:if(t=e.sent,r=t.data,200===r.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("获取用户列表数据失败!"));case 6:console.log("获取用户列表数据成功!"),this.userList=r.data.users,this.total=r.data.total;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},stateChange:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])({url:"users/".concat(t.id,"/state/").concat(t.mg_state),method:"put"});case 2:if(r=e.sent,a=r.data,200===a.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("修改用户状态数据失败!"));case 6:console.log("修改用户状态数据成功!");case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),resetEditDialog:function(){this.$refs.editRuleFormRef.resetFields()},editDialog:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.rowId=t.id,e.next=3,Object(o["a"])({url:"users/".concat(t.id)});case 3:if(r=e.sent,a=r.data,console.log(a),200===a.meta.status){e.next=8;break}return e.abrupt("return",this.$message.error("修改表单数据失败!"));case 8:console.log("修改表单数据成功!"),this.editRuleForm=a.data,this.editDialogVisible=!0;case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deleteUsersById:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(r=e.sent,"confirm"===r){e.next=5;break}return e.abrupt("return",this.$message.info("取消了删除操作"));case 5:return e.next=7,Object(o["a"])({url:"users/".concat(t.id),method:"delete"});case 7:if(a=e.sent,s=a.data,200===s.meta.status){e.next=11;break}return e.abrupt("return",this.$message.error("删除用户列表数据失败!"));case 11:console.log("删除用户列表数据成功!"),this.getUserList();case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),addUserDialog:function(){this.addDialogVisible=!0},resetAddUserDialog:function(){this.$refs.addRuleFormRef.resetFields()},addUser:function(){var e=this;this.$refs.addRuleFormRef.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(o["a"])({url:"users",method:"post",data:e.addRuleForm});case 4:if(a=t.sent,s=a.data,201===s.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("添加新用户数据失败!"));case 8:console.log("添加新用户数据成功!"),e.addDialogVisible=!1,e.getUserList();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},editUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])({url:"users/".concat(this.rowId),method:"put",data:this.editRuleForm});case 2:if(t=e.sent,r=t.data,200===r.meta.status){e.next=6;break}return e.abrupt("return",this.$message.error("修改用户列表数据失败!"));case 6:console.log("修改用户列表数据成功!"),this.editDialogVisible=!1,this.getUserList();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),allotRoles:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.userInfo=t,e.next=3,Object(o["a"])({url:"roles"});case 3:if(r=e.sent,a=r.data,console.log(a),200===a.meta.status){e.next=8;break}return e.abrupt("return",this.$message.error("获取角色列表数据失败!"));case 8:console.log("获取角色列表数据成功!"),this.rolesList=a.data,this.allotRolesDialogVisible=!0;case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),allotRolesConfirm:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.selectedRoles){e.next=2;break}return e.abrupt("return",this.$message.error("请选择要分配的角色"));case 2:return e.next=4,Object(o["a"])({url:"users/".concat(this.userInfo.id,"/role"),method:"put",data:{rid:this.selectedRoles}});case 4:if(t=e.sent,r=t.data,200===r.meta.status){e.next=8;break}return e.abrupt("return",this.$message.error("分配角色数据失败!"));case 8:console.log("分配角色数据成功!"),this.getUserList(),this.allotRolesDialogVisible=!1;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}},u=l,c=(r("d4a8"),r("0b56")),d=Object(c["a"])(u,a,s,!1,null,"62153d58",null);t["default"]=d.exports},d4a8:function(e,t,r){"use strict";r("3df7")}}]);
//# sourceMappingURL=home.02de5f5f.js.map